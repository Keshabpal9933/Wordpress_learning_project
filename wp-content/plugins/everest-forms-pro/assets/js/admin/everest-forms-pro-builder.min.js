!function(u,e,a){var m={init:function(){m.bindUIActions(),m.checkEnabledPayments(),u(function(){m.initializeRangeSliderFields(),u(document.body).on("evf_field_drop_complete",function(e,i,r){"range-slider"===i&&(m.initializeRangeSliderField(r),u("#everest-forms-field-option-"+r).find(".evf-show-slider-input").attr("checked","checked"),u("#everest-forms-field-"+r).find(".evf-slider-input-wrapper").show())}),u(document.body).on("evf_render_node_complete",function(e,i,r,n,o){if("range-slider"===i){var t="";n.find(".irs").remove(),n.find(".evf-slider .evf-range-slider-preview").hide(),t=o.find(".everest-forms-field-option-row-handle_color .wp-picker-input-wrap label").html(),o.find(".everest-forms-field-option-row-handle_color .wp-picker-container").remove(),o.find(".everest-forms-field-option-row-handle_color").append(t),t=o.find(".everest-forms-field-option-row-highlight_color .wp-picker-input-wrap label").html(),o.find(".everest-forms-field-option-row-highlight_color .wp-picker-container").remove(),o.find(".everest-forms-field-option-row-highlight_color").append(t),t=o.find(".everest-forms-field-option-row-track_color .wp-picker-input-wrap label").html(),o.find(".everest-forms-field-option-row-track_color .wp-picker-container").remove(),o.find(".everest-forms-field-option-row-track_color").append(t),m.initializeRangeSliderField(r)}})})},initializeRangeSliderFields:function(){u(document.body).on("change",".everest-forms-field-option .evf-range-slider-skin",m.updateRangeSliderBasicOptions),u(document.body).on("input",".everest-forms-field-option .everest-forms-field-option-row-min_value .evf-input-number",m.updateRangeSliderBasicOptions),u(document.body).on("input",".everest-forms-field-option .everest-forms-field-option-row-max_value .evf-input-number",m.updateRangeSliderBasicOptions),u(document.body).on("input",".everest-forms-field-option .everest-forms-field-option-row-min_max_values .evf-input-number",m.updateRangeSliderBasicOptions),u(document.body).on("change",".everest-forms-field-option .evf-range-slider-show-grid",m.updateRangeSliderBasicOptions),u(document.body).on("change",".everest-forms-field-option .evf-show-slider-prefix-postfix",m.updateRangeSliderBasicOptions),u(document.body).on("input",".everest-forms-field-option .everest-forms-field-option-row-default_value input",m.updateRangeSliderBasicOptions),u(document.body).on("change",".everest-forms-field-option .evf-use-text-prefix-postfix",m.updateRangeSliderBasicOptions),u(document.body).on("input",".everest-forms-field-option .evf-input-prefix-text, .everest-forms-field-option .evf-input-postfix-text",m.updateRangeSliderBasicOptions),u(document.body).on("change",".everest-forms-field-option .evf-show-slider-input",m.updateRangeSliderBasicOptions),u(".everest-forms-field.everest-forms-field-range-slider").each(function(e){var i=u(this).data("field-id");m.initializeRangeSliderField(i)})},initializeRangeSliderField:function(e){u("#everest-forms-field-"+e).find(".evf-range-slider-preview").ionRangeSlider(),m.initializeSliderHandleColorOption(e),m.initializeSliderHighlightColorOption(e),m.initializeSliderTrackColorOption(e),m.updateRangeSliderBasicOptions(e),m.updateRangeSliderColors(e)},initializeSliderHandleColorOption:function(e){var t=u("#everest-forms-field-option-"+e);t.find(".evf-range-slider-handle-color").wpColorPicker({change:function(e,i){var r=u(e.target).val(),n=u(this).closest(".everest-forms-field-option-row").data("field-id"),o=t.find(".evf-range-slider-skin").val();m.setSliderHandleColor(n,r,o)}})},initializeSliderHighlightColorOption:function(e){var n=u("#everest-forms-field-"+e);u("#everest-forms-field-option-"+e).find(".evf-range-slider-highlight-color").wpColorPicker({change:function(e,i){var r=u(e.target).val();r&&n.find(".irs-bar").css("background",r)}})},initializeSliderTrackColorOption:function(e){var n=u("#everest-forms-field-"+e);u("#everest-forms-field-option-"+e).find(".evf-range-slider-track-color").wpColorPicker({change:function(e,i){var r=u(e.target).val();r&&n.find(".irs-line").css("background",r)}})},updateRangeSliderColors:function(e){var i=u("#everest-forms-field-"+e),r=u("#everest-forms-field-option-"+e),n=r.find(".evf-range-slider-skin").val(),o=r.find(".evf-range-slider-handle-color").val(),t=r.find(".evf-range-slider-highlight-color").val(),s=r.find(".evf-range-slider-track-color").val();m.setSliderHandleColor(e,o,n),i.find(".irs-bar").css("background",t),i.find(".irs-line").css("background",s)},setSliderHandleColor:function(e,i,r){if(""!==e){var n=u("#everest-forms-field-"+e),o="";switch(r){case"flat":n.find(".irs-handle i").first().css("background-color",i),n.find(".irs-single").css("background-color",i),o="#everest-forms-field-"+e+" .irs-single:before { border-top-color: "+i+"!important; }";break;case"big":n.find(".irs-single").css("background-color",i),n.find(".irs-single").css("background",i),n.find(".irs-handle").css("background-color",i),n.find(".irs-handle").css("background",i);break;case"modern":n.find(".irs-handle i").css("background",i),n.find(".irs-single").css("background-color",i),o="#everest-forms-field-"+e+" .irs-single:before { border-top-color: "+i+"!important; }";break;case"sharp":n.find(".irs-handle").css("background-color",i),n.find(".irs-handle i").first().css("border-top-color",i),n.find(".irs-single").css("background-color",i),o="#everest-forms-field-"+e+" .irs-single:before { border-top-color: "+i+"!important; }";break;case"round":case"square":n.find(".irs-handle").css("border-color",i),n.find(".irs-single").css("background-color",i),o="#everest-forms-field-"+e+" .irs-single:before { border-top-color: "+i+"!important; }"}u("body").find(".evf-range-slider-handle-style-tag-"+e).remove(),u("body").append('<style class="evf-range-slider-handle-style-tag-'+e+'" >'+o+"</style>")}},updateRangeSliderBasicOptions:function(e){e="string"==typeof e?e:u(".everest-forms-field-option:visible").data("field-id");var i=u("#everest-forms-field-"+e),r=u("#everest-forms-field-option-"+e),n=parseFloat(u("#everest-forms-field-option-"+e+"-min_value").val()),o=parseFloat(u("#everest-forms-field-option-"+e+"-max_value").val()),t=u("#everest-forms-field-option-"+e+"-skin").val(),s=parseFloat(u("#everest-forms-field-option-"+e+"-default_value").val()),a=u("#everest-forms-field-option-"+e+"-show_grid").is(":checked"),d=u("#everest-forms-field-option-"+e+"-show_prefix_postfix").is(":checked"),l=u("#everest-forms-field-option-"+e+"-use_text_prefix_postfix").is(":checked"),f=u("#everest-forms-field-option-"+e+"-show_slider_input").is(":checked"),c={};if(n<o?(""!==n&&(c.min=n),""!==o&&(c.max=o)):u("#everest-forms-field-option-"+e+"-max_value").val(n+1),u("#everest-forms-field-option-"+e+"-max_value").attr("min",n+1),c.skin=""!==t?t:"round",""!==t&&(c.skin=t),c.grid=!!a,d?(c.hide_min_max=!1,u("#everest-forms-field-option-row-"+e+"-use_text_prefix_postfix").show(),u("#everest-forms-field-option-"+e).find(".evf-prefix-postfix-warning-message").show()):(c.hide_min_max=!0,u("#everest-forms-field-option-row-"+e+"-use_text_prefix_postfix").hide(),u("#everest-forms-field-option-"+e).find(".evf-prefix-postfix-warning-message").hide()),""!==s&&(c.from=s),f?i.find(".evf-slider-input-wrapper").show():i.find(".evf-slider-input-wrapper").hide(),i.find("input.evf-range-slider-preview").data("ionRangeSlider").update(c),i.find(".evf-slider-input").val(s),d&&l){var p=r.find(".evf-input-prefix-text").val(),v=r.find(".evf-input-postfix-text").val();i.find("span.irs-min").html(p),i.find("span.irs-max").html(v),r.find(".evf-range-slider-prefix-postfix-texts").show()}else r.find(".evf-range-slider-prefix-postfix-texts").hide();!d||d&&l?r.find(".evf-prefix-postfix-warning-message").hide():r.find(".evf-prefix-postfix-warning-message").show(),m.updateRangeSliderColors(e)},bindUIActions:function(){$builder=u("#everest-forms-builder"),$builder.on("change",".everest-forms-field-option-row-password_strength input",function(e){u(this).parent().find(".everest-forms-inner-options").toggleClass("everest-forms-visible everest-forms-hidden")}),u(document.body).on("blur",".evf-number-of-stars[type=number]",function(){u(".evf_error_tip").fadeOut("100",function(){u(this).remove()})}).on("change click",".evf-number-of-stars[type=number]",function(e){100<parseInt(u(this).val(),10)&&(u(this).val("100"),m.livePreviewNumberOfRating(u(this)))}).on("keyup click",".evf-number-of-stars[type=number]",function(){100<parseInt(u(this).val(),10)?u(document.body).triggerHandler("evf_add_error_tip",[u(this),"i18n_field_rating_greater_than_max_value_error",e]):u(document.body).triggerHandler("evf_remove_error_tip",[u(this),"i18n_field_rating_greater_than_max_value_error"])}),u(document).on("keyup mouseup",".everest-forms-field-option-row-number_of_stars input",function(){m.livePreviewNumberOfRating(this)}),u(document).on("input",".everest-forms-field-map-table .key-source",function(){m.updateUserMetakey(this)}),u(document).on("click",".everest-forms-addable-list .add",function(){m.userMetaAdd(this)}),u(document).on("click",".everest-forms-addable-list .remove",function(){m.userMetaRemove(this)}),u(document).on("change",".everest-forms-field-option-row-rating-icon input[type=radio]",function(){var e=u(this),i=e.val(),r=e.parent().data("field-id"),n=u("#everest-forms-field-"+r+" .rating-icon").find("svg").first().css("fill");$icons=u("#everest-forms-field-"+r+" .rating-icon"),iconClass='<svg width="32" height="32" viewBox="0 0 32 32" style="fill:'+n+'"><path d="M20.33 11.45L16 2.69l-4.33 8.76L2 12.86l7 6.82-1.65 9.64L16 24.77l8.65 4.55L23 19.68l7-6.82-9.67-1.41z"/></svg>',"heart"===i?iconClass='<svg width="32" height="32" viewBox="0 0 32 32" style="fill:'+n+'"><path d="M27.66 16.94L16 28 4.34 16.94a7.31 7.31 0 0 1 0-10.72A8.21 8.21 0 0 1 10 4a6.5 6.5 0 0 1 5 2l1 1s.88-.89 1-1a6.5 6.5 0 0 1 5-2 8.21 8.21 0 0 1 5.66 2.22 7.31 7.31 0 0 1 0 10.72z"/></svg>':"thumb"===i?iconClass='<svg width="32" height="32" viewBox="0 0 32 32" style="fill:'+n+'"><path d="M30 14.88a3.42 3.42 0 0 0-3.36-3.36h-4.85l.14-.42a2.42 2.42 0 0 1 .2-.39c.08-.14.14-.24.17-.31.21-.4.37-.72.48-1a7.39 7.39 0 0 0 .33-1.05A5.71 5.71 0 0 0 23 4a3.48 3.48 0 0 0-3-2 1.61 1.61 0 0 0-1.43.89C18.34 3.13 17 7 17 7a5.44 5.44 0 0 1-1 2c-.57.75-2.6 3-3.2 3.71s-1.05 1-1.33 1C10 13.74 10 15.71 10 16v9c0 .3 0 2.2 1.52 2.2a12.7 12.7 0 0 1 2.76.77A15.6 15.6 0 0 0 21 30a8.9 8.9 0 0 0 5.74-1.92C30 25 30 15.88 30 14.88zM5 14a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0v-7a3 3 0 0 0-3-3zm0 11a1 1 0 1 1 1-1 1 1 0 0 1-1 1z"/></svg>':"smiley"===i?iconClass='<svg width="32" height="32" viewBox="0 0 32 32" style="fill:'+n+'"><path d="M16 2a14 14 0 1 0 14 14A14 14 0 0 0 16 2zm4 8a2 2 0 1 1-2 2 2 2 0 0 1 2-2zm-8 0a2 2 0 1 1-2 2 2 2 0 0 1 2-2zm4 14a9.23 9.23 0 0 1-8.16-4.89l1.32-.71a7.76 7.76 0 0 0 13.68 0l1.32.71A9.23 9.23 0 0 1 16 24z"/></svg>':"bulb"===i&&(iconClass='<svg width="32" height="32" viewBox="0 0 32 32" style="fill:'+n+'"><path d="M16 2.25A9.76 9.76 0 0 0 6.25 12c0 3.21 2 5.68 3.52 7.48A6.28 6.28 0 0 1 11.25 23a.76.76 0 0 0 .75.75h8a.74.74 0 0 0 .74-.64 10 10 0 0 1 1.53-3.69c.24-.35.49-.7.75-1.06 1.28-1.77 2.73-3.79 2.73-6.36A9.76 9.76 0 0 0 16 2.25zM20 25.25h-8a.75.75 0 0 0 0 1.5h8a.75.75 0 0 0 0-1.5zM19 28.25h-6a.75.75 0 0 0 0 1.5h6a.75.75 0 0 0 0-1.5z"/></svg>'),$icons.html(iconClass)}),u(".everest-forms-field-option-row-icon_color input.colorpicker").wpColorPicker({change:function(e){var i=u(this),r=i.val(),n=i.closest(".everest-forms-field-option-row").data("field-id");u("#everest-forms-field-"+n+" .rating-icon svg").css("fill",r)}}),u(document).on("change",".everest-forms-field-option-row-show_hide_password input",function(){var e=u(this).parent().data("field-id");this.checked?u("#everest-forms-field-"+e).find(".toggle-password").removeClass("everest-forms-hidden"):u("#everest-forms-field-"+e).find(".toggle-password").addClass("everest-forms-hidden")}),$builder.on("change","#everest-forms-panel-field-paymentsstripe-enable_stripe",function(){m.checkEnabledPayments()}),$builder.on("input",".everest-forms-field-option-row-item_price input",function(e){var i,r=u(this),n=r.val(),o=r.parent().data("field-id"),t=m.amountSanitize(n),s=m.amountFormat(t);i="right"===a.currency_symbol_pos?s+" "+a.currency_symbol:a.currency_symbol+" "+s,u("#everest-forms-field-"+o).find(".widefat").val(s),u("#everest-forms-field-"+o).find(".price").text(i)}),$builder.on("input",".evf-money-input",function(e){var i=u(this),r=i.val(),n=i[0].selectionStart,o=i[0].selectionEnd;i.val(r.replace(/[^0-9.,]/g,"")),i[0].setSelectionRange(n,o)}),$builder.on("focusout",".evf-money-input",function(e){var i=u(this),r=i.val(),n=m.amountSanitize(r),o=m.amountFormat(n);i.val(o)})},amountSanitize:function(e){return e=e.replace(/[^0-9.,]/g,""),","===a.currency_decimal&&-1!==e.indexOf(a.currency_decimal)?("."===a.currency_thousands&&-1!==e.indexOf(a.currency_thousands)?e=e.replace(a.currency_thousands,""):""===a.currency_thousands&&-1!==e.indexOf(".")&&(e=e.replace(".","")),e=e.replace(a.currency_decimal,".")):","===a.currency_thousands&&-1!==e.indexOf(a.currency_thousands)&&(e=e.replace(a.currency_thousands,"")),m.numberFormat(e,2,".","")},amountFormat:function(e){if(e=String(e),","===a.currency_decimal&&-1!==e.indexOf(a.currency_decimal)){var i=e.indexOf(a.currency_decimal);whole=e.substr(0,i),part=e.substr(i+1,e.strlen-1),e=whole+"."+part}return","===a.currency_thousands&&-1!==e.indexOf(a.currency_thousands)&&(e=e.replace(",","")),e=e||0,m.numberFormat(e,2,a.currency_decimal,a.currency_thousands)},numberFormat:function(e,i,r,n){e=(e+"").replace(/[^0-9+\-Ee.]/g,"");var o,t,s,a=isFinite(+e)?+e:0,d=isFinite(+i)?Math.abs(i):0,l=void 0===n?",":n,f=void 0===r?".":r,c="";return 3<(c=(d?(o=a,t=d,s=Math.pow(10,t),""+(Math.round(o*s)/s).toFixed(t)):""+Math.round(a)).split("."))[0].length&&(c[0]=c[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,l)),(c[1]||"").length<d&&(c[1]=c[1]||"",c[1]+=new Array(d-c[1].length+1).join("0")),c.join(f)},livePreviewNumberOfRating:function(e){var i=u(e),r=i.val(),n=i.parent().data("field-id"),o=u("#everest-forms-field-"+n+" .rating-icon").first();if(r<=100){u("#everest-forms-field-"+n+" .rating-icon").remove();for(var t=1;t<=r;t++)u("#everest-forms-field-"+n).append(o.clone())}},updateUserMetakey:function(e){var i=u(e);value=i.val(),$destination=i.parent().parent().find(".key-destination"),name=$destination.data("name"),value&&$destination.attr("name",name.replace("{source}",value.replace(/[^0-9a-zA-Z_-]/gi,"")))},userMetaAdd:function(e){var i=u(e),r=i.closest("li"),n=i.closest("ul").find("li").length,o=r.clone().insertAfter(r);if(o.find("input").val(""),o.find("select :selected").prop("selected",!1),o.find(".key-destination").attr("name",""),void 0!==i.closest("ul").attr("data-tax")){var t=i.closest("ul").attr("data-tax"),s=n+1;o.find(".key").find(".everest-forms-"+t+"-map-select").attr("name","settings[post_tax_"+t+"]["+s+"]"),o.find(".field").find(".everest-forms-"+t+"-field-map-options").attr("name","settings[post_tax_"+t+"_value]["+s+"]")}},userMetaRemove:function(e){var i=u(e),r=i.closest("li");"1"<i.closest("ul").find("li").length&&r.remove()},checkEnabledPayments:function(){u("#everest-forms-panel-field-paymentsstripe-enable_stripe").prop("checked")?u("#everest-forms-add-fields-credit-card").removeClass("enable-stripe-model"):u("#everest-forms-add-fields-credit-card").addClass("enable-stripe-model")}};m.init(jQuery)}(jQuery,everest_forms_builder,evf_data);