jQuery(function(l){if("undefined"==typeof everest_forms_params)return!1;var o={init:function(){l(document).ready(o.ready);var e=l(".evf-single-item-price-hidden input[type=hidden]").length,t=l(".evf-field-payment-single input[type=text]").length,i=l(".evf-single-item-price").find("span").length;0!==e&&0==t&&0==i?(l(".evf-single-item-price-hidden input[type=hidden]").closest(".evf-field-payment-single").hide(),l(".evf-field-payment-total").hide()):(l(".evf-single-item-price-hidden input[type=hidden]").closest(".evf-field-payment-single").hide(),l(".evf-field-payment-total").show()),this.init_range_sliders(),this.load_validation(),o.bindUIActions()},ready:function(){o.loadPayments(),o.loadPhoneField(),o.loadCountryFlags()},init_range_sliders:function(){l(".evf-field.evf-field-range-slider").show(),l().ionRangeSlider&&l(".evf-field-range-slider").length&&(l(".evf-field-range-slider .evf-field-primary-input").ionRangeSlider({onFinish:function(e){var t=e.input.closest(".evf-field");o.setPrefixPostfixTexts(null,null,t)}}).on("change",function(){var e=l(this).val();l(this).closest(".evf-field-range-slider").find(".evf-slider-input").val(e),o.setSliderColors(l(this).closest(".evf-field"))}),l(".evf-field-range-slider .evf-slider-input").on("input",function(){var e=l(this).val(),t=l(this).closest(".evf-field");l(this).closest(".evf-field-range-slider").find(".evf-field-primary-input").data("ionRangeSlider").update({from:e}),o.setPrefixPostfixTexts(null,null,t)}),l(".evf-field-range-slider .evf-range-slider-reset-icon").on("click",function(e){var t=l(this).closest(".evf-field"),i=t.find(".evf-field-primary-input").data("default");t.find(".evf-field-primary-input").data("ionRangeSlider").update({from:i}),o.setSliderColors(l(this).closest(".evf-field")),o.setPrefixPostfixTexts(null,null,t)}),l(".evf-field.evf-field-range-slider").each(function(){var e=l(this).closest(".evf-field");o.setSliderColors(this),o.setPrefixPostfixTexts(null,null,e)}))},setPrefixPostfixTexts:function(e,t,i){var n=null!==i&&undefined!==i;if(e&&""!==e&&t&&""!==t||n){var s=(i=n?i:l("#evf-"+t+"-field_"+e+"-container")).find(".evf-field-primary-input"),a=s.data("use-text-prefix-postfix"),r=s.data("prefix-text"),o=s.data("postfix-text");!0===a&&(i.find("span.irs-min").html(r),i.find("span.irs-max").html(o))}},setSliderColors:function(e){var t=l(e).find(".evf-field-primary-input"),i=t.data("highlight_color"),n=t.data("track_color");o.setSliderHandleColor(e),l(e).find(".irs-bar").css("background",i),l(e).find(".irs-line").css("background",n)},setSliderHandleColor:function(e){if(e){var t=l(e),i=t.attr("id"),n=t.find(".evf-field-primary-input").data("skin"),s=t.find(".evf-field-primary-input").data("handle_color"),a="";switch(n){case"flat":t.find(".irs-handle i").first().css("background-color",s),t.find(".irs-single").css("background-color",s),a="#"+i+" .irs-single:before { border-top-color: "+s+"!important; }";break;case"big":t.find(".irs-single").css("background-color",s),t.find(".irs-single").css("background",s),t.find(".irs-handle").css("background-color",s),t.find(".irs-handle").css("background",s);break;case"modern":t.find(".irs-handle i").css("background",s),t.find(".irs-single").css("background-color",s),a="#"+i+" .irs-single:before { border-top-color: "+s+"!important; }";break;case"sharp":t.find(".irs-handle").css("background-color",s),t.find(".irs-handle i").first().css("border-top-color",s),t.find(".irs-single").css("background-color",s),a="#"+i+" .irs-single:before { border-top-color: "+s+"!important; }";break;case"round":case"square":t.find(".irs-handle").css("border-color",s),t.find(".irs-single").css("background-color",s),a="#"+i+" .irs-single:before { border-top-color: "+s+"!important; }"}l("body").find(".evf-range-slider-handle-style-tag-"+i).remove(),l("body").append('<style class="evf-range-slider-handle-style-tag-'+i+'" >'+a+"</style>")}},load_validation:function(){if("undefined"==typeof l.fn.validate)return!1;l.validator.addMethod("extension",function(e,t,i){return i="string"==typeof i?i.replace(/,/g,"|"):"png|jpe?g|gif",this.optional(t)||e.match(new RegExp("\\.("+i+")$","i"))},everest_forms_params.i18n_messages_fileextension),l.validator.addMethod("maxsize",function(e,t,i){var n,s,a=i,r=this.optional(t);if(r)return r;if(t.files&&t.files.length)for(n=0,s=t.files.length;n<s;n++)if(t.files[n].size>a)return!1;return!0},everest_forms_params.i18n_messages_filesize),"undefined"!=typeof l.fn.intlTelInput&&l.validator.addMethod("smart-phone-field",function(e,t){return this.optional(t)||l(t).intlTelInput("isValidNumber")},everest_forms_params.i18n_messages_phone)},loadPayments:function(){l(".evf-payment-total").each(function(e,t){o.amountTotal(this)})},loadPhoneField:function(){var s={};if("undefined"==typeof l.fn.intlTelInput)return!1;if("yes"!==everest_forms_params.disable_user_details&&(s.geoIpLookup=o.currentIpToCountry),"yes"===everest_forms_params.disable_user_details)var e=this.getFirstBrowserLanguage(),t=-1<e.indexOf("-")?e.split("-").pop():"";if(t){var i=window.intlTelInputGlobals.getCountryData();t=(i=i.filter(function(e){return e.iso2===t.toLowerCase()})).length?t:""}s.initialCountry="yes"===everest_forms_params.disable_user_details&&t?t:"auto",l(".evf-smart-phone-field").each(function(e,t){var i=l(t);s.hiddenInput=i.closest(".evf-field-phone").data("field-id"),s.utilsScript=everest_forms_pro_params.plugin_url+"assets/js/intlTelInput/utils.js",i.intlTelInput(s);var n=i.attr("name")+"[phone_field]";i.attr("name",n),i.blur(function(){i.intlTelInput("isValidNumber")&&i.siblings('input[type="hidden"]').val(i.intlTelInput("getNumber"))})})},loadCountryFlags:function(){"undefined"!=typeof l.fn.selectWoo&&l("select.evf-country-flag-selector:visible").each(function(){var e=l.extend({placeholder:l(this).attr("placeholder")||"",templateResult:function(e){return e.id?l('<div class="iti__flag-box"><div class="iti__flag iti__'+e.id.toLowerCase()+'"></div></div><span class="iti__country-name">'+e.text+"</span>"):e.text},templateSelection:function(e){return e.id?l('<div class="iti__flag-box"><div class="iti__flag iti__'+e.id.toLowerCase()+'"></div></div><span class="iti__country-name">'+e.text+"</span>"):e.text}},{language:{noResults:function(){return everest_forms_params.i18n_no_countries}}});l(this).selectWoo(e)})},getFirstBrowserLanguage:function(){var e,t,i=window.navigator,n=["language","browserLanguage","systemLanguage","userLanguage"];if(Array.isArray(i.languages))for(e=0;e<i.languages.length;e++)if((t=i.languages[e])&&t.length)return t;for(e=0;e<n.length;e++)if((t=i[n[e]])&&t.length)return t;return""},currentIpToCountry:function(n){l.get("https://ipapi.co/json").always(function(e){var t=e&&e.country?e.country:"";if(!t){var i=o.getFirstBrowserLanguage();t=-1<i.indexOf("-")?i.split("-").pop():""}n(t)})},bindUIActions:function(){l(document).on("change input",".evf-payment-price",function(){o.amountTotal(this,!0)}),l(document.body).on("conditional_show conditional_hide",function(e,t){var i=l(t).find(".evf-payment-price");l(i).length&&o.amountTotal(i,!0)}),l(document).on("input",".evf-payment-user-input",function(){var e=l(this),t=e.val();e.val(t.replace(/[^0-9.,]/g,""))}),l(document).on("focusout",".evf-payment-user-input",function(){var e=l(this),t=e.val(),i=o.amountSanitize(t),n=o.amountFormat(i);e.val(n)}),l(".everest-forms-field-rating").hover(function(){l(this).parent().find(".everest-forms-field-rating").removeClass("selected hover"),l(this).prevAll().andSelf().addClass("hover")},function(){l(this).parent().find(".everest-forms-field-rating").removeClass("selected hover"),l(this).parent().find("input:checked").parent().prevAll().andSelf().addClass("selected")}),l(document).on("change",".everest-forms-field-rating input",function(){var e=l(this);e.closest(".everest-forms-field-rating-container").find(".everest-forms-field-rating").removeClass("hover selected"),e.parent().prevAll().andSelf().addClass("selected")}),l(document).ready(function(){l(".everest-forms-field-rating input:checked").change()}),l(document).on("click",".toggle-password",function(){var e=l(this),t=l(e.attr("toggle"));e.toggleClass("dashicons-visibility"),"password"===t.attr("type")?t.attr("type","text"):t.attr("type","password")})},amountTotal:function(e,t){t=t||!1;var i,a=l(e).closest(".everest-form"),r=0,n=0,s=o.getCurrency();a.find('.evf-field .evf-payment-price:enabled, .evf-field .evf-single-item-price-hidden input[type="hidden"]:enabled').each(function(e,t){var i=l(this),n=0;"text"===i.attr("type")||"hidden"===i.attr("type")?n=i.val():"radio"!==i.attr("type")&&"checkbox"!==i.attr("type")||!i.is(":checked")?i.is("select")&&0<i.find("option:selected").length&&(n=i.find("option:selected").data("amount")):n=i.data("amount"),o.empty(n)||(n=o.amountSanitize(n),r=Number(r)+Number(n))}),a.find(".evf-payment-quantity").length&&a.find(".evf-payment-quantity").each(function(e,t){if(0<l(t).val()&&(form_id=a.data("formid"),map_field_id=l(t).data("map_field"),$mapped_field=l("#evf-"+form_id+"-field_"+map_field_id),$mapped_field.is(".evf-payment-price")&&$mapped_field.is(":enabled")||$mapped_field.find(".evf-payment-price").is(":enabled"))){var i,n=$mapped_field.val().replace(",","."),s=l(t).val();$mapped_field.closest(".evf-field").is(".evf-field-payment-multiple")?$mapped_field.find(".evf-payment-price:checked").length&&(i=$mapped_field.find(".evf-payment-price:checked").data("amount"),isNaN(parseFloat(i))||(n=parseFloat(i),r-=n,r+=s*n)):$mapped_field.closest(".evf-field").is(".evf-field-payment-checkbox")?$mapped_field.find(".evf-payment-price:checked").each(function(){i=l(this).data("amount"),isNaN(parseFloat(i))||(n=parseFloat(i),r-=n,r+=s*n)}):isNaN(parseFloat(n))||(n=parseFloat(n),r-=n,r+=s*n)}}),i=o.amountFormat(r),n="left"===s.symbol_pos?s.symbol+" "+i:i+" "+s.symbol,a.find(".evf-payment-total").each(function(){"hidden"===l(this).attr("type")||"text"===l(this).attr("type")?(l(this).val(n),"text"===l(this).attr("type")&&t&&a.data("validator")&&l(this).valid()):l(this).text(n)})},amountSanitize:function(e){var t=o.getCurrency();return e=e.toString().replace(/[^0-9.,]/g,""),","===t.decimal_sep&&-1!==e.indexOf(t.decimal_sep)?("."===t.thousands_sep&&-1!==e.indexOf(t.thousands_sep)?e=e.replace(t.thousands_sep,""):""===t.thousands_sep&&-1!==e.indexOf(".")&&(e=e.replace(".","")),e=e.replace(t.decimal_sep,".")):","===t.thousands_sep&&-1!==e.indexOf(t.thousands_sep)&&(e=e.replace(t.thousands_sep,"")),o.numberFormat(e,2,".","")},amountFormat:function(e){var t=o.getCurrency();if(e=String(e),","===t.decimal_sep&&-1!==e.indexOf(t.decimal_sep)){var i=e.indexOf(t.decimal_sep);e=e.substr(0,i)+"."+e.substr(i+1,e.strlen-1)}return","===t.thousands_sep&&-1!==e.indexOf(t.thousands_sep)&&(e=e.replace(",","")),o.empty(e)&&(e=0),o.numberFormat(e,2,t.decimal_sep,t.thousands_sep)},getCurrency:function(){var e={code:"USD",thousands_sep:",",decimal_sep:".",symbol:"$",symbol_pos:"left"};return"undefined"!=typeof evf_settings.currency_code&&(e.code=evf_settings.currency_code),"undefined"!=typeof evf_settings.currency_thousands&&(e.thousands_sep=evf_settings.currency_thousands),"undefined"!=typeof evf_settings.currency_decimal&&(e.decimal_sep=evf_settings.currency_decimal),"undefined"!=typeof evf_settings.currency_symbol&&(e.symbol=evf_settings.currency_symbol),"undefined"!=typeof evf_settings.currency_symbol_pos&&(e.symbol_pos=evf_settings.currency_symbol_pos),e},numberFormat:function(e,t,i,n){e=(e+"").replace(/[^0-9+\-Ee.]/g,"");var s,a,r,o,l=isFinite(+e)?+e:0,d=isFinite(+t)?Math.abs(t):0,f=void 0===n?",":n,c=void 0===i?".":i;return 3<(s=(d?(a=l,r=d,o=Math.pow(10,r),""+(Math.round(a*o)/o).toFixed(r)):""+Math.round(l)).split("."))[0].length&&(s[0]=s[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,f)),(s[1]||"").length<d&&(s[1]=s[1]||"",s[1]+=new Array(d-s[1].length+1).join("0")),s.join(c)},empty:function(e){var t,i,n,s=[void 0,null,!1,0,"","0"];for(i=0,n=s.length;i<n;i++)if(e===s[i])return!0;if("object"!=typeof e)return!1;for(t in e)if(e.hasOwnProperty(t))return!1;return!0}};o.init(jQuery)});